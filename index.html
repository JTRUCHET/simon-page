<script>
  window.onload = function () {
    const iframe = document.querySelector("iframe");

    iframe.onload = () => {
      try {
        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;

        // ⏳ Attendre que Notion ait rendu les jours
        const interval = setInterval(() => {
          const headerCells = iframeDoc.querySelectorAll('[style*="display: flex"] [style*="font-weight: 500"]');

          if (headerCells.length === 7 && headerCells[0]?.textContent?.toLowerCase().includes('dim')) {
            // Supprimer la colonne de dimanche
            headerCells[0].parentElement.parentElement.remove(); // En-tête
            const rows = iframeDoc.querySelectorAll('[style*="display: flex"][style*="align-items: stretch"]');

            rows.forEach(row => {
              const firstCell = row.querySelector(':scope > div');
              if (firstCell) firstCell.remove();
            });

            clearInterval(interval);
          }
        }, 300);
      } catch (e) {
        console.warn("Impossible de modifier l’iframe Notion (politique de sécurité du navigateur).");
      }
    };
  };
</script>
